!function(w){sitemartThemeModule.$document.on("djShopPageInit",function(){sitemartThemeModule.ajaxSearch()}),w.each(["frontend/element_ready/dj_search.default"],function(e,t){sitemartThemeModule.djElementorAddAction(t,function(){sitemartThemeModule.ajaxSearch()})}),sitemartThemeModule.ajaxSearch=function(){void 0!==w.fn.devbridgeAutocomplete&&w("form.sitemart-ajax-search").each(function(){var o=w(this),s=parseInt(o.data("count")),n=parseInt(o.data("thumbnail")),d=parseInt(o.data("symbols_count")),r=o.find('[name="product_cat"]'),e=o.parent(),i=e.find(".dj-dropdown-results > .dj-scroll-content"),l=o.data("post_type"),c=sitemart_settings.ajaxurl+"?action=ajax_search",u=parseInt(o.data("price")),p=o.data("sku"),m=o.parents(".dj-search-full-screen-2").length,h=e.find(".dj-dropdown-results");0<s&&(c+="&number="+s),c+="&post_type="+l,i.on("click",".view-all-results",function(){}),r.length&&""!==r.val()&&(c+="&product_cat="+r.val()),o.find('[type="text"]').on("focus keyup cat_selected",function(e){var t=w(this),a={action:"ajax_search",number:0<s?s:void 0,post_type:l};m&&h.removeClass("dj-no-results"),t.hasClass("dj-search-inited")||(t.devbridgeAutocomplete({serviceUrl:c,appendTo:i,minChars:d,deferRequestBy:sitemart_settings.ajax_search_delay,onSelect:function(e){0<e.permalink.length&&(window.location.href=e.permalink)},onHide:function(){h.removeClass("dj-opened")},onSearchStart:function(){o.addClass("search-loading")},beforeRender:function(e){w(e).find(".suggestion-divider-title").parent().addClass("suggestion-divider"),w(e).find(".no-found-msg").parent().addClass("suggestion-no-found"),2<e[0].childElementCount&&w(e).append('<div class="view-all-results"><span>'+sitemart_settings.all_results+"</span></div>"),w(e).removeAttr("style")},onSearchComplete:function(){o.removeClass("search-loading"),sitemartThemeModule.$document.trigger("dfsd-images-loaded")},formatResult:function(e,t){var t="("+(t="&"===t?"&#038;":t).replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+")",a="";return e.divider&&(a+=' <h5 class="suggestion-divider-title">'+e.divider+"</h5>"),n&&e.thumbnail&&(a+=' <div class="suggestion-thumb">'+e.thumbnail+"</div>"),e.value&&(a=(a+=' <div class="suggestion-content set-cont-mb-s reset-last-child">')+'<h4 class="dj-entities-title">'+e.value.replace(new RegExp(t,"gi"),"<strong>$1</strong>").replace(/&lt;(\/?strong)&gt;/g,"<$1>")+"</h4>"),p&&e.sku&&(a+=' <p class="suggestion-sku">'+e.sku+"</p>"),u&&e.price&&(a+=' <p class="price">'+e.price+"</p>"),e.value&&(a+=" </div>"),e.products_not_found&&(a='<span class="no-found-msg">'+e.value+"</span>"),m&&e.no_results&&h.addClass("dj-no-results"),h.addClass("dj-opened"),o.parents("div[class*='dj-search-full-']").addClass("dj-searched"),a}}),t.addClass("dj-search-inited")),r.length&&"cat_selected"===e.type&&(""!==r.val()&&(a.product_cat=r.val()),t=o.find('[type="text"]').devbridgeAutocomplete(),e=sitemart_settings.ajaxurl+"?"+new URLSearchParams(a).toString(),t.setOptions({serviceUrl:e}),t.hide(),t.onValueChange())}),sitemartThemeModule.$document.on("click",function(e){e=e.target;w(e).is(".dj-search-form")||w(e).parents().is(".dj-search-form")||w(e).is(".dj-search-full-screen")||w(e).parents().is(".dj-search-full-screen")||o.find('[type="text"]').devbridgeAutocomplete("hide")}),w(".dj-dropdown-results > .dj-scroll-content").on("click",function(e){e.stopPropagation()})})},w(document).ready(function(){sitemartThemeModule.ajaxSearch()})}(jQuery);